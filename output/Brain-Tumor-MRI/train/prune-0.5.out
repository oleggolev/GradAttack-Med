/scratch/network/ogolev/GradAttack-Med/data/brain-tumor-MRI
[RandomResizedCrop(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=bilinear), RandomHorizontalFlip(p=0.5), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]
[Resize(size=(256, 256), interpolation=bilinear), CenterCrop(size=(224, 224)), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Applied defenses:
	Defense name: GradPruneDefense	Parameters: p: 0.5	
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Set SLURM handle signals.

  | Name                  | Type             | Params
-----------------------------------------------------------
0 | _model                | ResNet           | 11.2 M
1 | _training_loss_metric | CrossEntropyLoss | 0     
-----------------------------------------------------------
11.2 M    Trainable params
0         Non-trainable params
11.2 M    Total params
44.673    Total estimated model params size (MB)
/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py:474: UserWarning: This DataLoader will create 48 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Traceback (most recent call last):
  File "/scratch/network/ogolev/GradAttack-Med/examples/train_brain_tumor_mri.py", line 77, in <module>
    pipeline.run()
  File "/scratch/network/ogolev/GradAttack-Med/gradattack/trainingpipeline.py", line 41, in run
    return self.trainer.fit(self.model, self.datamodule)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 458, in fit
    self._run(model)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 756, in _run
    self.dispatch()
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 797, in dispatch
    self.accelerator.start_training(self)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/accelerators/accelerator.py", line 96, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 144, in start_training
    self._results = trainer.run_stage()
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 807, in run_stage
    return self.run_train()
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 842, in run_train
    self.run_sanity_check(self.lightning_module)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in run_sanity_check
    self.run_evaluation()
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 962, in run_evaluation
    output = self.evaluation_loop.evaluation_step(batch, batch_idx, dataloader_idx)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/trainer/evaluation_loop.py", line 174, in evaluation_step
    output = self.trainer.accelerator.validation_step(args)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/accelerators/accelerator.py", line 226, in validation_step
    return self.training_type_plugin.validation_step(*args)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 161, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "/scratch/network/ogolev/GradAttack-Med/gradattack/models/__init__.py", line 339, in validation_step
    y_hat = self.forward(x)
  File "/scratch/network/ogolev/GradAttack-Med/gradattack/models/__init__.py", line 103, in forward
    return self._model(x)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/network/ogolev/GradAttack-Med/gradattack/models/resnet.py", line 213, in forward
    out = self.linear(out)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 94, in forward
    return F.linear(input, self.weight, self.bias)
  File "/scratch/network/ogolev/GradAttack-Med/grad-attack-env/lib/python3.9/site-packages/torch/nn/functional.py", line 1753, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: mat1 dim 1 must match mat2 dim 0

Validation sanity check: 0it [00:00, ?it/s]
Validation sanity check:   0%|          | 0/1 [00:00<?, ?it/s]
                                                              
srun: error: della-l02g9: task 0: Exited with exit code 1
srun: Terminating StepId=56200972.0
